<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>For My Princess ‚ù§Ô∏è</title>

<!-- Preload the audio with URL encoding for safety -->
<link rel="preload" href="Until_I_Found_You-%5BAudioTrimmer.com%5D.mp3" as="audio" type="audio/mpeg">

<style>
/* =====================
   GLOBAL
===================== */
body {
  margin: 0;
  overflow: hidden;
  font-family: "Roboto", serif;
  background: linear-gradient(135deg, #2b1b2f, #3a2342, #1f1426);
  user-select: none; /* Prevent text selection while dragging */
}

/* =====================
   PLAY SCREEN
===================== */
#play-screen {
  position: fixed;
  inset: 0;
  background: linear-gradient(135deg, #2b1b2f, #3a2342, #1f1426);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: 9999;
  color: white;
  transition: opacity 0.8s ease, visibility 0.8s;
}

#play-btn {
  font-size: 1.5rem;
  padding: 16px 45px;
  border-radius: 50px;
  border: none;
  cursor: pointer;
  background: #ff5fa2;
  color: white;
  font-weight: bold;
  box-shadow: 0 12px 35px rgba(255,95,162,0.5);
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

#play-btn:hover {
  transform: scale(1.08);
  box-shadow: 0 18px 45px rgba(255,95,162,0.7);
}

#play-screen p {
  margin-top: 18px;
  opacity: 0.85;
  font-size: 1.1rem;
}

/* =====================
   HEARTS
===================== */
.hearts {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 0;
}

.heart {
  position: absolute;
  bottom: -40px;
  animation: floatUp linear infinite;
}

.heart svg {
  fill: var(--heart-color);
  opacity: 0.9;
  filter: drop-shadow(0 0 6px rgba(255,255,255,0.35));
}

@keyframes floatUp {
  from { transform: translateY(0) scale(0.85); opacity: 0.9; }
  to { transform: translateY(-120vh) scale(1.15); opacity: 0; }
}

/* =====================
   CAROUSEL
===================== */
.carousel {
  position: relative;
  height: 100vh;
  overflow: hidden;
  pointer-events: none;
}

.carousel-item {
  --items: 10;
  --width: clamp(150px, 30vw, 300px);
  --height: clamp(200px, 40vw, 400px);
  --x: calc(var(--active) * 800%);
  --y: calc(var(--active) * 200%);
  --rot: calc(var(--active) * 120deg);
  --opacity: calc(var(--zIndex) / var(--items) * 3 - 2);

  position: absolute;
  width: var(--width);
  height: var(--height);
  top: 50%;
  left: 50%;
  margin: calc(var(--height) * -0.5) 0 0 calc(var(--width) * -0.5);
  border-radius: 10px;
  background: black;
  box-shadow: 0 10px 50px rgba(0,0,0,.5);
  pointer-events: all; /* Allows dragging */
  transform: translate(var(--x), var(--y)) rotate(var(--rot));
  transition: transform 0.8s cubic-bezier(0,0.02,0,1);
  z-index: var(--zIndex);
}

.carousel-item img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  border-radius: 10px;
}

.title {
  position: absolute;
  bottom: 20px;
  left: 20px;
  color: white;
  text-shadow: 0 2px 4px rgba(0,0,0,0.8);
  font-size: clamp(18px, 3vw, 24px);
  font-weight: bold;
  z-index: 2;
  width: 90%;
}

.num {
  position: absolute;
  top: 10px;
  left: 20px;
  color: white;
  font-size: clamp(24px, 8vw, 60px);
  font-weight: 900;
  opacity: 0.6;
  z-index: 2;
  text-shadow: 0 2px 4px rgba(0,0,0,0.5);
}

/* Add a gradient overlay to make text readable */
.carousel-item::after {
  content: "";
  position: absolute;
  inset: 0;
  background: linear-gradient(to top, rgba(0,0,0,0.7) 0%, transparent 40%);
  border-radius: 10px;
  pointer-events: none;
}
</style>
</head>

<body>

<!-- PLAY SCREEN -->
<div id="play-screen">
  <button id="play-btn">‚ñ∂ Play the Music</button>
  <p>Best experienced with music üé∂</p>
</div>

<!-- AUDIO -->
<!-- Using URL encoded filename to ensure it loads correctly -->
<audio id="bg-music" loop>
  <source src="Until_I_Found_You-%5BAudioTrimmer.com%5D.mp3" type="audio/mpeg">
</audio>

<!-- HEARTS -->
<div class="hearts"></div>

<!-- CAROUSEL -->
<div class="carousel">
  <div class="carousel-item"><div class="title">Heyyy Pretty üëã</div><div class="num">01</div><img src="1.jpeg" alt="Photo 1"></div>
  <div class="carousel-item"><div class="title">I want to tell you something</div><div class="num">02</div><img src="2.jpeg" alt="Photo 2"></div>
  <div class="carousel-item"><div class="title">Please keep dragging üòä</div><div class="num">03</div><img src="3.jpeg" alt="Photo 3"></div>
  <div class="carousel-item"><div class="title">You are Amazing ü§©</div><div class="num">04</div><img src="4.jpeg" alt="Photo 4"></div>
  <div class="carousel-item"><div class="title">Most Beautiful Person üíØ</div><div class="num">05</div><img src="5.jpeg" alt="Photo 5"></div>
  <div class="carousel-item"><div class="title">And Obviously Cutest üéÄ</div><div class="num">06</div><img src="6.jpeg" alt="Photo 6"></div>
  <div class="carousel-item"><div class="title">Since I matched with you üòó</div><div class="num">07</div><img src="7.jpeg" alt="Photo 7"></div>
  <div class="carousel-item"><div class="title">Butterflies in my stomach ü•∞</div><div class="num">08</div><img src="8.jpeg" alt="Photo 8"></div>
  <div class="carousel-item"><div class="title">I feel lucky everyday üòá</div><div class="num">09</div><img src="9.jpeg" alt="Photo 9"></div>
  <div class="carousel-item"><div class="title">I love You ‚ù§Ô∏è</div><div class="num">10</div><img src="10.jpeg" alt="Photo 10"></div>
</div>

<script>
/* =====================
   CAROUSEL LOGIC
===================== */
let progress = 0;
let startX = 0;
let active = 0;
let isDown = false;

// Settings for drag speed
const speedWheel = 0.02;
const speedDrag = -0.1;

const items = document.querySelectorAll('.carousel-item');

// Calculate Z-index to stack cards correctly
const getZ = (arr, idx) =>
  arr.map((_, i) => idx === i ? arr.length : arr.length - Math.abs(idx - i));

function animate() {
  // Constrain progress between 0 and 100
  progress = Math.max(0, Math.min(progress, 100));
  
  // Calculate active index based on progress
  active = Math.floor(progress / 100 * (items.length - 1));

  items.forEach((item, i) => {
    item.style.setProperty('--zIndex', getZ([...items], active)[i]);
    item.style.setProperty('--active', (i - active) / items.length);
  });
}
animate();

// Click to jump to card
items.forEach((item, i) => {
  item.addEventListener('click', () => {
    progress = (i / items.length) * 100 + 10;
    animate();
  });
});

// Wheel scroll
document.addEventListener('wheel', e => {
  progress += e.deltaY * speedWheel;
  animate();
});

// Touch/Mouse Drag Logic
document.addEventListener('mousedown', e => {
  isDown = true;
  startX = e.clientX;
});
document.addEventListener('touchstart', e => {
  isDown = true;
  startX = e.touches[0].clientX;
});

document.addEventListener('mousemove', e => {
  if (!isDown) return;
  const x = e.clientX || (e.touches && e.touches[0].clientX);
  progress += (x - startX) * speedDrag;
  startX = x;
  animate();
});
document.addEventListener('touchmove', e => {
  if (!isDown) return;
  const x = e.touches[0].clientX;
  progress += (x - startX) * speedDrag;
  startX = x;
  animate();
});

document.addEventListener('mouseup', () => isDown = false);
document.addEventListener('touchend', () => isDown = false);

/* =====================
   HEART RAIN
===================== */
const heartsContainer = document.querySelector('.hearts');
const colors = [
  "rgba(255,255,255,0.9)",
  "rgba(255,200,210,0.9)",
  "rgba(230,215,255,0.9)",
  "rgba(200,230,255,0.9)"
];

function createHeart() {
  const heart = document.createElement('div');
  heart.className = 'heart';
  const size = 14 + Math.random() * 28;
  heart.style.width = heart.style.height = size + 'px';
  heart.style.left = Math.random() * 100 + 'vw';
  heart.style.animationDuration = (8 + Math.random() * 4) + 's';
  heart.style.setProperty('--heart-color', colors[Math.floor(Math.random() * colors.length)]);
  
  // SVG Heart Path
  heart.innerHTML = `<svg viewBox="0 0 32 29.6"><path d="M23.6,0c-3.4,0-6.4,2.1-7.6,5.1C14.8,2.1,11.8,0,8.4,0C3.8,0,0,3.8,0,8.4c0,9.4,16,21.2,16,21.2s16-11.8,16-21.2C32,3.8,28.2,0,23.6,0z"/></svg>`;
  
  heartsContainer.appendChild(heart);
  setTimeout(() => heart.remove(), 14000);
}

function heartRain() {
  // Generating multiple hearts per tick for a "heavy rain" effect
  createHeart();
  createHeart();
  createHeart();
  // Loop runs very frequently (every ~0.04 seconds)
  setTimeout(heartRain, 20 + Math.random() * 50);
}

/* =====================
   AUDIO PLAYBACK (Robust)
===================== */
const music = document.getElementById("bg-music");
const playBtn = document.getElementById("play-btn");
const playScreen = document.getElementById("play-screen");

playBtn.addEventListener("click", () => {
  // 1. Hide the play screen
  playScreen.style.opacity = "0";
  playScreen.style.visibility = "hidden";
  
  // 2. Start the heart animation
  heartRain();
  // Add a few extra hearts at the start for effect
  for(let i=0; i<5; i++) setTimeout(createHeart, i * 200);

  // 3. Play Music directly (No Web Audio API to avoid CORS issues)
  music.play().then(() => {
    console.log("Music started successfully");
  }).catch(error => {
    console.log("Playback failed:", error);
    alert("Music couldn't play automatically. Please check your device volume or permissions.");
  });
});
</script>

</body>
</html>